the solution from the book is totally useless.

In fact, it is very similar with the question in machine learning topic.

In machine learning area, we have better solution to solve it. 